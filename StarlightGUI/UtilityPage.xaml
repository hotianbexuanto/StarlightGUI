<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="StarlightGUI.UtilityPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:StarlightGUI"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:essential="using:WinUI3Package"
    mc:Ignorable="d">

    <Grid>
        <ScrollViewer Padding="20">
            <StackPanel>
                <TextBlock Text="系统行为控制" FontWeight="Bold" FontSize="14" Padding="10" HorizontalAlignment="Left"/>

                <!-- 创建进程 -->
                <essential:SettingsCard Header="创建进程"
                                    Description="禁止或允许全局创建进程"
                                    IsClickEnabled="True"
                                    IsActionIconVisible="False"
                                    Margin="0,0,0,10">
                    <essential:SettingsCard.HeaderIcon>
                        <FontIcon Glyph="&#xe9d9;" FontFamily="Segoe Fluent Icons" FontSize="16"/>
                    </essential:SettingsCard.HeaderIcon>
                    <StackPanel Orientation="Horizontal">
                        <Button Content="启用" Click="Button_Click" Tag="ENABLE_CREATE_PROCESS" Margin="0,0,16,0"/>
                        <Button Content="禁用" Click="Button_Click" Tag="DISABLE_CREATE_PROCESS"/>
                    </StackPanel>
                </essential:SettingsCard>

                <!-- 创建文件 -->
                <essential:SettingsCard Header="创建文件"
                                    Description="禁止或允许全局创建文件"
                                    IsClickEnabled="True"
                                    IsActionIconVisible="False"
                                    Margin="0,0,0,10">
                    <essential:SettingsCard.HeaderIcon>
                        <FontIcon Glyph="&#xed25;" FontFamily="Segoe Fluent Icons" FontSize="16"/>
                    </essential:SettingsCard.HeaderIcon>
                    <StackPanel Orientation="Horizontal">
                        <Button Content="启用" Click="Button_Click" Tag="ENABLE_CREATE_FILE" Margin="0,0,16,0"/>
                        <Button Content="禁用" Click="Button_Click" Tag="DISABLE_CREATE_FILE"/>
                    </StackPanel>
                </essential:SettingsCard>

                <!-- 加载驱动 -->
                <essential:SettingsCard Header="加载驱动"
                                    Description="禁止或允许系统加载驱动"
                                    IsClickEnabled="True"
                                    IsActionIconVisible="False"
                                    Margin="0,0,0,10">
                    <essential:SettingsCard.HeaderIcon>
                        <FontIcon Glyph="&#xe8ce;" FontFamily="Segoe Fluent Icons" FontSize="16"/>
                    </essential:SettingsCard.HeaderIcon>
                    <StackPanel Orientation="Horizontal">
                        <Button Content="启用" Click="Button_Click" Tag="ENABLE_LOAD_DRV" Margin="0,0,16,0"/>
                        <Button Content="禁用" Click="Button_Click" Tag="DISABLE_LOAD_DRV"/>
                    </StackPanel>
                </essential:SettingsCard>

                <!-- 卸载驱动 -->
                <essential:SettingsCard Header="卸载驱动"
                                    Description="禁止或允许系统卸载驱动"
                                    IsClickEnabled="True"
                                    IsActionIconVisible="False"
                                    Margin="0,0,0,10">
                    <essential:SettingsCard.HeaderIcon>
                        <FontIcon Glyph="&#xe8cd;" FontFamily="Segoe Fluent Icons" FontSize="16"/>
                    </essential:SettingsCard.HeaderIcon>
                    <StackPanel Orientation="Horizontal">
                        <Button Content="启用" Click="Button_Click" Tag="ENABLE_UNLOAD_DRV" Margin="0,0,16,0"/>
                        <Button Content="禁用" Click="Button_Click" Tag="DISABLE_UNLOAD_DRV"/>
                    </StackPanel>
                </essential:SettingsCard>

                <!-- 修改注册表 -->
                <essential:SettingsCard Header="修改注册表"
                                    Description="禁止或允许修改注册表"
                                    IsClickEnabled="True"
                                    IsActionIconVisible="False"
                                    Margin="0,0,0,10">
                    <essential:SettingsCard.HeaderIcon>
                        <FontIcon Glyph="&#xe9d5;" FontFamily="Segoe Fluent Icons" FontSize="16"/>
                    </essential:SettingsCard.HeaderIcon>
                    <StackPanel Orientation="Horizontal">
                        <Button Content="启用" Click="Button_Click" Tag="ENABLE_MODIFY_REG" Margin="0,0,16,0"/>
                        <Button Content="禁用" Click="Button_Click" Tag="DISABLE_MODIFY_REG"/>
                    </StackPanel>
                </essential:SettingsCard>

                <!-- 修改引导扇区 -->
                <essential:SettingsCard Header="修改引导扇区"
                                    Description="禁止或允许修改磁盘引导扇区"
                                    IsClickEnabled="True"
                                    IsActionIconVisible="False"
                                    Margin="0,0,0,10">
                    <essential:SettingsCard.HeaderIcon>
                        <FontIcon Glyph="&#xe8a6;" FontFamily="Segoe Fluent Icons" FontSize="16"/>
                    </essential:SettingsCard.HeaderIcon>
                    <StackPanel Orientation="Horizontal">
                        <Button Content="启用" Click="Button_Click" Tag="ENABLE_MODIFY_BOOTSEC" Margin="0,0,16,0"/>
                        <Button Content="禁用" Click="Button_Click" Tag="DISABLE_MODIFY_BOOTSEC"/>
                    </StackPanel>
                </essential:SettingsCard>

                <!-- 注册对象操作回调 -->
                <essential:SettingsCard Header="注册对象操作回调"
                                    Description="禁止或允许注册对象操作回调 (ObRegisterCallbacks)"
                                    IsClickEnabled="True"
                                    IsActionIconVisible="False"
                                    Margin="0,0,0,10">
                    <essential:SettingsCard.HeaderIcon>
                        <FontIcon Glyph="&#xe951;" FontFamily="Segoe Fluent Icons" FontSize="16"/>
                    </essential:SettingsCard.HeaderIcon>
                    <StackPanel Orientation="Horizontal">
                        <Button Content="启用" Click="Button_Click" Tag="ENABLE_OBJ_REG_CB" Margin="0,0,16,0"/>
                        <Button Content="禁用" Click="Button_Click" Tag="DISABLE_OBJ_REG_CB"/>
                    </StackPanel>
                </essential:SettingsCard>

                <!-- 注册注册表回调 -->
                <essential:SettingsCard Header="注册注册表回调"
                                    Description="禁止或允许注册注册表回调 (CmRegisterCallbackEx)"
                                    IsClickEnabled="True"
                                    IsActionIconVisible="False"
                                    Margin="0,0,0,10">
                    <essential:SettingsCard.HeaderIcon>
                        <FontIcon Glyph="&#xe951;" FontFamily="Segoe Fluent Icons" FontSize="16"/>
                    </essential:SettingsCard.HeaderIcon>
                    <StackPanel Orientation="Horizontal">
                        <Button Content="启用" Click="Button_Click" Tag="ENABLE_CM_REG_CB" Margin="0,0,16,0"/>
                        <Button Content="禁用" Click="Button_Click" Tag="DISABLE_CM_REG_CB"/>
                    </StackPanel>
                </essential:SettingsCard>

                <!-- 驱动签名强制 -->
                <essential:SettingsCard Header="驱动签名强制"
                                    Description="开启或关闭驱动签名强制 (Driver Signature Enforcement)"
                                    IsClickEnabled="True"
                                    IsActionIconVisible="False"
                                    Margin="0,0,0,10">
                    <essential:SettingsCard.HeaderIcon>
                        <FontIcon Glyph="&#xef3f;" FontFamily="Segoe Fluent Icons" FontSize="16"/>
                    </essential:SettingsCard.HeaderIcon>
                    <StackPanel Orientation="Horizontal">
                        <Button Content="启用" Click="Button_Click" Tag="ENABLE_DSE" Margin="0,0,16,0"/>
                        <Button Content="禁用" Click="Button_Click" Tag="DISABLE_DSE"/>
                    </StackPanel>
                </essential:SettingsCard>

                <!-- 本地内核调试 -->
                <essential:SettingsCard Header="本地内核调试"
                                    Description="开启或关闭本地内核调试"
                                    IsClickEnabled="True"
                                    IsActionIconVisible="False"
                                    Margin="0,0,0,10">
                    <essential:SettingsCard.HeaderIcon>
                        <FontIcon Glyph="&#xebe8;" FontFamily="Segoe Fluent Icons" FontSize="16"/>
                    </essential:SettingsCard.HeaderIcon>
                    <StackPanel Orientation="Horizontal">
                        <Button Content="启用" Click="Button_Click" Tag="ENABLE_LKD" Margin="0,0,16,0"/>
                        <Button Content="禁用" Click="Button_Click" Tag="DISABLE_LKD"/>
                    </StackPanel>
                </essential:SettingsCard>

                <TextBlock Text="系统操作" FontWeight="Bold" FontSize="14" Padding="10,0,0,0" HorizontalAlignment="Left"/>
                <TextBlock Text="(警告: 该区域的功能可能无法正常工作，导致蓝屏或崩溃是正常现象！)" FontSize="12" Padding="10,0,0,10" HorizontalAlignment="Left" Foreground="LightGray"/>

                <!-- 电源状态 -->
                <essential:SettingsCard Header="电源状态"
                                    Description="更改系统的电源状态"
                                    IsClickEnabled="True"
                                    IsActionIconVisible="False"
                                    Margin="0,0,0,10">
                    <essential:SettingsCard.HeaderIcon>
                        <Grid>
                            <FontIcon Glyph="&#xe7e8;" FontFamily="Segoe Fluent Icons" FontSize="16"/>
                        </Grid>
                    </essential:SettingsCard.HeaderIcon>
                    <StackPanel Orientation="Horizontal">
                        <Button Content="关机" Click="Button_Click2" Tag="POWER_SHUTDOWN" Margin="0,0,16,0"/>
                        <Button Content="重启" Click="Button_Click2" Tag="POWER_REBOOT" Margin="0,0,16,0"/>
                        <Button Content="强制重启" Click="Button_Click2" Tag="POWER_REBOOT_FORCE"/>
                    </StackPanel>
                </essential:SettingsCard>

                <!-- 蓝屏 -->
                <essential:SettingsCard Header="蓝屏"
                                    Description="使系统发生崩溃 (Blue Screen Of Death)"
                                    IsClickEnabled="True"
                                    IsActionIconVisible="False"
                                    Margin="0,0,0,10">
                    <essential:SettingsCard.HeaderIcon>
                        <Grid>
                            <FontIcon Glyph="&#xe783;" FontFamily="Segoe Fluent Icons" FontSize="16"/>
                        </Grid>
                    </essential:SettingsCard.HeaderIcon>
                    <StackPanel Orientation="Horizontal">
                        <ComboBox x:Name="BSODColorComboBox" 
                                  SelectedIndex="0"
                                  essential:ComboBoxHelper.AcrylicWorkaround="True"
                                  Margin="0,0,16,0">
                            <ComboBoxItem Content="默认" />
                            <ComboBoxItem Content="红色" />
                            <ComboBoxItem Content="绿色" />
                            <ComboBoxItem Content="蓝色" />
                            <ComboBoxItem Content="黄色" />
                            <ComboBoxItem Content="青色" />
                            <ComboBoxItem Content="品红色" />
                            <ComboBoxItem Content="黑色" />
                            <ComboBoxItem Content="白色" />
                            <ComboBoxItem Content="橙色" />
                            <ComboBoxItem Content="紫色" />
                            <ComboBoxItem Content="粉色" />
                            <ComboBoxItem Content="灰色" />
                            <ComboBoxItem Content="棕色" />
                            <ComboBoxItem Content="金色" />
                            <ComboBoxItem Content="银色" />
                        </ComboBox>
                        <Button Content="崩溃" Click="Button_Click" Tag="BSOD"/>
                    </StackPanel>
                </essential:SettingsCard>

                <!-- PatchGuard -->
                <essential:SettingsCard Header="禁用内核保护"
                                    Description="禁用内核PatchGuard保护"
                                    IsClickEnabled="True"
                                    IsActionIconVisible="False"
                                    Margin="0,0,0,10">
                    <essential:SettingsCard.HeaderIcon>
                        <Grid>
                            <FontIcon Glyph="&#xf540;" FontFamily="Segoe Fluent Icons" FontSize="16"/>
                        </Grid>
                    </essential:SettingsCard.HeaderIcon>
                    <StackPanel Orientation="Horizontal">
                        <ComboBox x:Name="PGTypeComboBox" 
                                  SelectedIndex="2"
                                  essential:ComboBoxHelper.AcrylicWorkaround="True"
                                  Margin="0,0,16,0">
                            <ComboBoxItem Content="EFI" />
                            <ComboBoxItem Content="BIOS" />
                            <ComboBoxItem Content="自动 (可能蓝屏)" />
                        </ComboBox>
                        <Button Content="禁用" Click="Button_Click" Tag="PatchGuard"/>
                    </StackPanel>
                </essential:SettingsCard>
            </StackPanel>
        </ScrollViewer>
        <StackPanel HorizontalAlignment="Right"
                    x:Name="InfoBarPanel" 
                    Margin="0,10,10,0"/>
    </Grid>
</Page>
